<?php
/**
 * Created by PhpStorm.
 * User: naomileow
 * Date: 14/11/14
 * Time: 12:23 PM
 */

namespace Phortress\Dephenses\Engine;


use Phortress\Dephenses\Error;
use Phortress\Dephenses\Taint\Annotation;
use Phortress\Dephenses\Taint\SanitisingFunctions;
use Phortress\Dephenses\Taint\Sinks;
use Phortress\Dephenses\Taint\TaintResult;
use PhpParser\Node\Expr\FuncCall;

class SQLVulnerabilityChecker extends VulnerabilityChecker{

	public function __construct(){
		$this->defaultMessageHeader = "SQL Injection Vulnerability was found in a call to ";
	}

	protected function containsSanitisingFunction(array $funcs){
		foreach($funcs as $func){
			var_dump($func);
			if(SanitisingFunctions::isSQLSanitisingFunction($func) ||
				SanitisingFunctions::isGeneralSanitisingFunction($func)){
				var_dump("yes");
				return true;
			}
		}
		return false;
	}

	protected function isVulnerabilitySink(FuncCall $funcCall){
		return Sinks::isSQLInjectionSinkFunction($funcCall);
	}
} 