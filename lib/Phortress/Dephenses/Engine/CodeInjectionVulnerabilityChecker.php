<?php
/**
 * Created by PhpStorm.
 * User: naomileow
 * Date: 19/11/14
 * Time: 2:14 AM
 */

namespace Phortress\Dephenses\Engine;


use Phortress\Dephenses\Taint\SanitisingFunctions;
use Phortress\Dephenses\Taint\Sinks;
use PhpParser\Node\Expr\FuncCall;

class CodeInjectionVulnerabilityChecker extends VulnerabilityChecker{
	public function __construct(){
		$this->defaultMessageHeader = "Code Injection Vulnerability was found in a call to ";
	}

	protected function containsSanitisingFunction(array $funcs){
		foreach($funcs as $func){
			if(SanitisingFunctions::isShellSanitisingFunction($func)){
				return true;
			}
		}
		return false;
	}

	protected function isVulnerabilitySink(FuncCall $funcCall){
		return Sinks::isCodeInjectionSinkFunction($funcCall);
	}
} 