<?php
/**
 * Created by PhpStorm.
 * User: naomileow
 * Date: 14/11/14
 * Time: 12:23 PM
 */

namespace Phortress\Dephenses\Engine;


use PhpParser\Node\Expr\FuncCall;

class SQLVulnerabilityFinder extends VulnerabilityFinder{

	protected function getSQLInjectionVulnerableNodes(){
		$sinkCondition = function ($node){
			if($node instanceof FuncCall){
				return \Sinks::isSQLInjectionSinkFunction($node);
			}else{
				return false;
			}
		};
		parent::getNodesToCheck($sinkCondition);
	}

	protected function getVulnerableNodes(){
		if(!empty($this->vulnerableNodes)){
			return $this->vulnerableNodes;
		}else{
			$nodes = getSQLInjectionVulnerableNodes();

		}
	}

	public function findVulnerabilities(){
		$vulnerables = $this->getVulnerableNodes();

	}
} 